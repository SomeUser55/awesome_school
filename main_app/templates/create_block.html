{% extends 'base.html' %}

{% set nav_item_id = 'create_block' %}


{% block content %}
    <form action="" method="post"  novalidate id='myform'>
        {{ form.hidden_tag() }}

        <div class="container">
            <div class="row">
                <div class="col-sm">
                    {{ form.title.label }}
                    {{ form.title(size=20) }}<br>
                    {% for error in form.title.errors %}
                    <span style="color: red;">[{{ error }}]</span>
                    {% endfor %}
                </div>

                <div class="col-sm">
                    {{ form.desc.label }}<br>
                    {{ form.desc(cols="46", rows="2") }}<br>
                    {% for error in form.desc.errors %}
                    <span style="color: red;">[{{ error }}]</span>
                    {% endfor %}
                </div>
                <div>{{ form.contest_ids() }}<br></div>
                <div class="col-sm">
                    {{ form.submit() }}
                </div>
            </div>
        </div>
    </form>


    <div class="container">
      <div class="row mt-4">
        <div class="col">
          <div class="jumbotron">

            Contests:
            <ul class="list-group" id="contests_from">
                {% for contest in contests %}
                    <li class="list-group-item" id={{ contest.id }}>{{ contest.title }}</li>
                {% endfor %}
            </ul>

            Block (drag and drop):
            <ul class="list-group mt-4" id="contests_to">
            </ul>
          </div>
        </div>
      </div>
    </div>
    
    <script src="https://cdn.jsdelivr.net/gh/RubaXa/Sortable/Sortable.min.js"></script>
    <link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,500,500i,700,700i" rel="stylesheet">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    

    <script>
        Sortable.create(contests_from, {
        animation: 100,
        group: 'list-1',
        draggable: '.list-group-item',
        handle: '.list-group-item',
        sort: true,
        filter: '.sortable-disabled',
        chosenClass: 'active'
        });
    
        Sortable.create(contests_to, {
        group: 'list-1',
        handle: '.list-group-item'
        });
    </script>

    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.11.1/jquery-ui.min.js"></script>

    <script>
        $(function () {
            $("#contests_to").sortable({
                change: function(event, ui) {
                var idsInOrder = $("#contests_to").sortable("toArray");
                alert('change');
                }
            });
        });
        $("#submit_button").on("click",
            function(e){
                // e.preventDefault();
                var idsInOrder = $("#contests_to").sortable("toArray");
                // alert('onclick');
                document.getElementById("contest_ids").value = idsInOrder.join(',');
                $("#myform").submit();
        });

    </script>

    
{% endblock %}

